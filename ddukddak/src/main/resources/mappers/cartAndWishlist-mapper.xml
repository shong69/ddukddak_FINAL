<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ddukddak.myPage.model.mapper.CartAndWishListMapper">

	<!-- 장바구니 상품 목록 조회 장바구니아이디로 옵션 조회 -> 옵션 아이디로 옵션 이름 조회 + 상품 넘버로   -->
	<select id="selectCartList">
	
		SELECT C.PRODUCT_NO, P.PRODUCT_NAME, P.PRODUCT_PRICE, C.PRODUCT_COUNT, O.OPTION_VALUE, U.PRODUCT_IMG, O.OPTION_NO
		FROM 
		    "CART" C
		JOIN 
		    PRODUCT P ON C.PRODUCT_NO = P.PRODUCT_NO
		LEFT JOIN 
		    "OPTION" O ON C.OPTION_NO = O.OPTION_NO
		LEFT JOIN 
		    (SELECT PRODUCT_NO, UPLOAD_IMG_PATH || UPLOAD_IMG_RENAME  PRODUCT_IMG FROM UPLOAD_FILE WHERE UPLOAD_IMG_ORDER = 0) U 
		    ON U.PRODUCT_NO = P.PRODUCT_NO
		WHERE C.MEMBER_NO = #{memberNo}
	</select>
	
	<!-- 장바구니 아이템 추가 -->
	<insert id="insertProduct">
		INSERT "CART"
		VALUES(어쩌구.NEXTVAL,#{productCount},#{memberNo},#{productNo},#{optionNo})
	</insert>
	
	<!-- 장바구니 아이템 수량 수정 -->
	<update id="updateCount">
		UPDATE SET "CART"
		PRODUCT_COUNT = #{productCount}
		WHERE MEMBER_NO = #{memberNo}
		AND PRODUCT_NO = #{productNo}
	</update>
	
	<!-- 장바구니 아이템 삭제 -->
	<delete id="deleteProduct">
		DELETE FROM "CART"
		WHERE MEMBER_NO = #{memberNo}
		AND PRODUCT_NO = #{productNo}
		AND OPTION_NO = #{optionNo}
	</delete>
	
	<!-- 장바구니 상품 추가 -->
	<insert id="insertCartItem">
		INSERT "CART"
		VALUES(SEQ_CART_ID.NEXTVAL,#{quantity},#{memberNo},#{productNo})
	</insert>
	
	<!-- 장바구니 상품 옵션 추가 -->
	<insert id="insertCartItem">
		INSERT "CARTITEM_OPTION"
		VALUES(SEQ_CART_ID.CURRVAL,#{oneOption},SEQ_CARTITEM_OPTION_ID.NEXTVAL)
	</insert>
	

</mapper>
