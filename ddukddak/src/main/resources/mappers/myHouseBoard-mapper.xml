<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ddukddak.board.model.mapper.MyHouseBoardMapper">
	
	<!-- 집들이 게시글 작성 -->
	<insert id="boardInsert" useGeneratedKeys="true" parameterType="Board">
		
		<selectKey order="BEFORE" resultType="_int" keyProperty="boardNo">
			SELECT SEQ_BOARD_NO.NEXTVAL FROM DUAL
		</selectKey>
		
		INSERT INTO "COMMUNITY"
		VALUES ( #{boardNo},
				 #{boardTitle},
				 #{boardContent},
				 DEFAULT,
				 NULL,
				 DEFAULT,
				 DEFAULT,
				 #{memberNo},
				 1)
		
	</insert>
	
	<!-- 게시글 이미지 삽입 -->
	<insert id="insertUploadList" parameterType="list">
		
		INSERT INTO "UPLOAD_FILE"
		
		<foreach collection="list" item="img"
				open="(" close=")" separator=" UNION ">
		
		
				SELECT NEXT_UPLOAD_IMG_NO(),
					   #{img.uploadImgPath},
					   #{img.uploadImgOgName},
					   #{img.uploadImgRename},
					   #{img.uploadImgOrder},
					   3,
					   NULL,
					   #{img.boardNo},
					   NULL,
					   NULL
			  	FROM DUAL
				   
		</foreach>
		
	</insert>
	
	
	<select id="selectMyHouseList">
		SELECT BOARD_NO, 
			 BOARD_TITLE, 
			 BOARD_CONTENT, 
			 BOARD_WRITE_DATE, 
			 BOARD_UPDATE_DATE, 
			 READ_COUNT,
			 MEMBER_NO,
			 MEMBER_NICKNAME
		FROM COMMUNITY
		JOIN "MEMBER" USING (MEMBER_NO)
		WHERE BOARD_DEL_FL ='N'
		AND   BOARD_CODE = #{boardType}
	</select>
	
	
</mapper>
